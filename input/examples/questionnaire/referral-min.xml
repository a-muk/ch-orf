<Questionnaire xmlns="http://hl7.org/fhir">
    <id value="referral-min" />
    <meta>
        <profile value="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-questionnaire" />
        <profile value="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire" />
        <profile value="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-extract" />
    </meta>
    <extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-targetStructureMap">
        <valueCanonical value="http://fhir.ch/ig/ch-orf/StructureMap/OrfQrToBundle" />
    </extension>
    <url value="http://fhir.ch/ig/ch-orf/Questionnaire/referral-min"/>
    <name value="ORFReferralMinimial" />
    <title value="ORF Referral Minimial" />
    <status value="draft" />
    <experimental value="true" />
    <subjectType value="Patient" />
    <date value="2020-12-17" />
    <publisher value="eHealth Suisse"/>

    <extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-launchContext">
        <extension url="name">
            <valueId value="Bundle"/>
        </extension>
        <extension url="type">
            <valueCode value="Bundle"/>
        </extension>
        <extension url="description">
            <valueString value="The Bundle that is to be used to pre-populate the form"/>
        </extension>
    </extension>
    <extension url="http://hl7.org/fhir/StructureDefinition/variable">
        <valueExpression>
            <name value="Patient"/>
            <language value="text/fhirpath"/>
            <expression value="%Bundle.entry[0].resource.subject.resolve()"/>
        </valueExpression>
    </extension>
    <extension url="http://hl7.org/fhir/StructureDefinition/variable">
        <valueExpression>
            <name value="Orderer"/>
            <language value="text/fhirpath"/>
            <expression value="%Bundle.entry[0].resource.author.resolve().ofType(Practitioner)"/>
        </valueExpression>
    </extension>

    <item>
        <linkId value="order" />
        <text value="Auftrag" />
        <type value="group" />
        <required value="true" />
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="%Bundle.entry[0].resource.extension.where(url=&#39;http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-visitnumber&#39;).valueIdentifier.value" />
                </valueExpression>
            </extension>-->
            <linkId value="order.placerOrderId" />
            <text value="Auftragsnummer des Auftraggebers" />
            <type value="string" />
        </item>
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="" />
                </valueExpression>
            </extension>-->
            <linkId value="order.fillerOrderId" />
            <text value="Auftragsnummer des Empfängers" />
            <type value="string" />
        </item>
    </item>

    <item>
        <linkId value="receiver" />
        <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-practitionerrole" />
        <text value="Empfänger" />
        <type value="group" />
        <repeats value="true" />
        <item>
            <linkId value="receiver.practitioner" />
            <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-practitioner" />
            <text value="Empfangende Person" />
            <type value="group" />
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                    <valueExpression>
                        <language value="text/fhirpath"/>
                        <expression value="" />
                    </valueExpression>
                </extension>-->
                <linkId value="receiver.practitioner.familyName" />
                <text value="Name" />
                <type value="string" />
            </item>
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                    <valueExpression>
                        <language value="text/fhirpath"/>
                        <expression value="%Orderer.name.given" />
                    </valueExpression>
                </extension>-->
                <linkId value="receiver.practitioner.givenName" />
                <text value="Vorname" />
                <type value="string" />
            </item>
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                <linkId value="receiver.practitioner.title" />
                <text value="Titel" />
                <type value="string" />
            </item>
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                <linkId value="receiver.practitioner.gln" />
                <text value="GLN" />
                <type value="string" />
            </item>
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                <linkId value="receiver.practitioner.phone" />
                <text value="Telefon" />
                <type value="string" />
            </item>
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                <linkId value="receiver.practitioner.email" />
                <text value="E-Mail" />
                <type value="string" />
            </item>
        </item>
        <item>
            <linkId value="receiver.organization" />
            <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-organization" />
            <text value="Empfangende Organisation" />
            <type value="group" />
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                <linkId value="receiver.organization.name" />
                <text value="Name der Organisation" />
                <type value="string" />
            </item>
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                <linkId value="receiver.organization.streetAddressLine" />
                <text value="Strasse, Hausnummer, Postfach etc." />
                <type value="string" />
                <repeats value="true" />
            </item>
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                <linkId value="receiver.organization.postalCode" />
                <text value="PLZ" />
                <type value="string" />
            </item>
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                <linkId value="receiver.organization.city" />
                <text value="Ort" />
                <type value="string" />
            </item>
            <item>
                <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                <linkId value="receiver.organization.country" />
                <text value="Land" />
                <type value="string" />
            </item>
        </item>
    </item>

    <item>
        <linkId value="patient" />
        <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient" />
        <text value="Patient" />
        <type value="group" />
        <item>
            <extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <!--  %Bundle.entry[0].resource.subject.resolve().name.family -->
                    <expression value="%Patient.name.family" />
                </valueExpression>
            </extension>
            <linkId value="patient.familyName" />
            <text value="Name" />
            <type value="string" />
        </item>
        <item>
            <extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <!-- %Bundle.entry[0].resource.subject.resolve().name.given" -->
                    <expression value="%Patient.name.given" />
                </valueExpression>
            </extension>
            <linkId value="patient.givenName" />
            <text value="Vorname" />
            <type value="string" />
        </item>
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="" />
                </valueExpression>
            </extension>-->
            <linkId value="patient.localPid" />
            <text value="Lokale Patienten-ID" />
            <type value="string" />
        </item>
        <item>
            <extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <!--  %Bundle.entry[0].resource.subject.resolve().birthDate" -->
                    <expression value="%Patient.birthDate" />
                </valueExpression>
            </extension>
            <linkId value="patient.birthDate" />
            <text value="Geburtsdatum" />
            <type value="date" />
        </item>
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="" />
                </valueExpression>
            </extension>-->
            <linkId value="patient.gender" />
            <text value="Geschlecht" />
            <type value="choice"/>
            <answerOption>
                <valueString value="M" />
            </answerOption>
            <answerOption>
                <valueString value="F" />
            </answerOption>
        </item>
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="" />
                </valueExpression>
            </extension>-->
            <linkId value="patient.phone" />
            <text value="Telefon" />
            <type value="string" />
        </item>
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="" />
                </valueExpression>
            </extension>-->
            <linkId value="patient.email" />
            <text value="E-Mail" />
            <type value="string" />
        </item>
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="" />
                </valueExpression>
            </extension>-->
            <linkId value="patient.streetAddressLine" />
            <text value="Strasse, Hausnummer, Postfach etc." />
            <type value="string" />
            <repeats value="true" />
        </item>
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="" />
                </valueExpression>
            </extension>-->
            <linkId value="patient.postalCode" />
            <text value="PLZ" />
            <type value="string" />
        </item>
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="" />
                </valueExpression>
            </extension>-->
            <linkId value="patient.city" />
            <text value="Ort" />
            <type value="string" />
        </item>
        <item>
            <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                <valueExpression>
                    <language value="text/fhirpath"/>
                    <expression value="" />
                </valueExpression>
            </extension>-->
            <linkId value="patient.country" />
            <text value="Land" />
            <type value="string" />
        </item>
    </item>

    <item>
        <linkId value="orderer" />
        <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-practitionerrole" />
        <text value="Auftraggeber" />
        <type value="group" />
        <required value="true" />
        <item>
            <linkId value="orderer.author" />
            <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-practitioner" />
            <text value="Verantwortlicher" />
            <type value="group" />
            <required value="true" />
            <item>
                <linkId value="orderer.author.practitioner" />
                <text value="Verantwortliche Person" />
                <type value="group" />
                <item>
                    <extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <!--  %Bundle.entry[0].resource.author.resolve().ofType(Practitioner).name.family -->
                            <expression value="%Orderer.name.family" />
                        </valueExpression>
                    </extension>
                    <linkId value="orderer.author.practitioner.familyName" />
                    <text value="Name" />
                    <type value="string" />
                </item>
                <item>
                    <extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <!--  %Bundle.entry[0].resource.author.resolve().ofType(Practitioner).name.given -->
                            <expression value="%Orderer.name.given" />
                        </valueExpression>
                    </extension>
                    <linkId value="orderer.author.practitioner.givenName" />
                    <text value="Vorname" />
                    <type value="string" />
                </item>
                <item>
                    <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                    <linkId value="orderer.author.practitioner.title" />
                    <text value="Titel" />
                    <type value="string" />
                </item>
                <item>
                    <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                    <linkId value="orderer.author.practitioner.gln" />
                    <text value="GLN" />
                    <type value="string" />
                </item>
                <item>
                    <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                    <linkId value="orderer.author.practitioner.phone" />
                    <text value="Telefon" />
                    <type value="string" />
                </item>
                <item>
                    <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                    <linkId value="orderer.author.practitioner.email" />
                    <text value="E-Mail" />
                    <type value="string" />
                </item>
            </item>
            <item>
                <linkId value="orderer.author.organization" />
                <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-organization" />
                <text value="Verantwortliche Organisation" />
                <type value="group" />
                <item>
                    <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                    <linkId value="orderer.author.organization.name" />
                    <text value="Name der Organisation" />
                    <type value="string" />
                </item>
                <item>
                    <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                    <linkId value="orderer.author.organization.streetAddressLine" />
                    <text value="Strasse, Hausnummer, Postfach etc." />
                    <type value="string" />
                    <repeats value="true" />
                </item>
                <item>
                    <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                    <linkId value="orderer.author.organization.postalCode" />
                    <text value="PLZ" />
                    <type value="string" />
                </item>
                <item>
                    <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                    <linkId value="orderer.author.organization.city" />
                    <text value="Ort" />
                    <type value="string" />
                </item>
                <item>
                    <!--<extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression">
                        <valueExpression>
                            <language value="text/fhirpath"/>
                            <expression value="" />
                        </valueExpression>
                    </extension>-->
                    <linkId value="orderer.author.organization.country" />
                    <text value="Land" />
                    <type value="string" />
                </item>
            </item>
        </item>
    </item>
</Questionnaire>